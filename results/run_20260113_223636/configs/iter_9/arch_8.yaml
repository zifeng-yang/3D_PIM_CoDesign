architecture:
  version: 0.4
  
  nodes:
    # --- Level 0: System Attributes ---
    - !Container
      name: system
      attributes:
        technology: "28nm"
        global_cycle_seconds: 1e-9

    # --- Level 3: Off-chip Memory (DRAM) ---
    - !Component
      name: DRAM
      class: DRAM
      attributes:
        technology: "28nm"
        type: "LPDDR4"
        width: 256
        datawidth: 16
        depth: 67108864 
        block_size: 16
        word_bits: 16
        meshX: 1

    # --- Level 2: PIM Nodes (Parallel Vaults) ---
    - !Hierarchical
      nodes:
        - !Container
          name: PIM_Node
          attributes:
            technology: "28nm"
            meshX: 4 
          spatial:
            meshX: 4 

        # Level 1.5: Node-local SRAM (必须叫 Node_SRAM)
        - !Component
          name: Node_SRAM
          class: SRAM
          attributes:
            technology: "28nm"
            width: 64
            depth: 262144
            datawidth: 16
            word_bits: 16
            meshX: 4 
          spatial:
            meshX: 1 

        # --- Level 1: PE Array ---
        - !Hierarchical
          nodes:
            - !Container
              name: PE_Array
              attributes:
                technology: "28nm"
                meshX: 4 
              spatial:
                meshX: 20
                meshY: 20
            
            # Level 0.5: Registers
            - !Component
              name: RegFile
              class: regfile
              attributes:
                technology: "28nm"
                width: 16
                depth: 64
                datawidth: 16
                word_bits: 16
                meshX: 1600 
            
            # Level 0: MAC Units
            - !Component
              name: MAC
              class: "intmac"
              attributes:
                technology: "28nm"
                datawidth: 16
                multiplier_width: 8
                adder_width: 16
                meshX: 1600