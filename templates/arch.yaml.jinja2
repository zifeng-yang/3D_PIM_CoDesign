architecture:
  version: 0.4
  nodes:
  # ============================================================
  # 1. System
  # ============================================================
  - !Container
    name: system
    attributes:
      technology: "{{ TECHNOLOGY }}"
      global_cycle_seconds: {{ GLOBAL_CYCLE_SECONDS }}
  
  # ============================================================
  # 2. DRAM
  # ============================================================
  - !Component
    name: SEDRAM
    class: DRAM
    attributes:
      type: "LPDDR4"
      width: {{ DRAM_WIDTH }}
      datawidth: {{ DRAM_WIDTH }}

  # ============================================================
  # 3. PIM Level (2D Mesh Hierarchy)
  # ============================================================
  - !Container
    name: Chip
    attributes: {latency: 0}

  - !Container
    name: PIM_Node_Column
    spatial: {meshX: {{ MESH_X }}} 
    
  - !Container
    name: PIM_Node_Row
    spatial: {meshY: {{ MESH_Y }}}

  - !Component
    name: Node_SRAM
    class: smartbuffer_SRAM 
    attributes:
      depth: {{ SRAM_DEPTH }}
      width: {{ SRAM_WIDTH }}
      datawidth: {{ WORD_BITS }}
      read_bandwidth: 16
      write_bandwidth: 16

  # ============================================================
  # 4. PE Level
  # ============================================================
  - !Container
    name: PE_column
    spatial: {meshX: {{ PE_DIM_X }}}

  - !Container
    name: PE_row
    spatial: {meshY: {{ PE_DIM_Y }}}

  # ============================================================
  # 5. Register File
  # ============================================================
  - !Component
    name: shared_rf
    class: smartbuffer_RF
    attributes:
      depth: 512   
      width: 16
      datawidth: {{ WORD_BITS }}

  # ============================================================
  # 6. MAC Unit
  # ============================================================
  - !Component 
    name: MAC
    class: {{ MAC_CLASS }}
    attributes:
      multiplier_width: {{ WORD_BITS }}
      adder_width: {{ WORD_BITS * 2 }}
      datawidth: {{ WORD_BITS }}
